<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novinky</title>
    <!-- Include Custom Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
</head>
<body>
    <!-- Add the news-container div -->
    <div class="container mt-5">
        <div id="news-container" class="row"></div>
    </div>
    
    <!-- Include Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <!-- Include Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <!-- Include PapaParse -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQXlfXRcfpV8LdX0ZlryLEwwOs8YgzHLrgFsGheBJ5bSuR9CMGBkZlQPNQNyO_rJxCNWkoedIvZOkq5/pub?output=csv';
            const proxyUrl = 'https://corsproxy.io/?';

            fetch(proxyUrl + sheetUrl)
                .then(response => response.text())
                .then(data => {
                    console.log('Fetched CSV Data:', data); // Log the fetched CSV data
                    Papa.parse(data, {
                        header: true,
                        complete: function(results) {
                            console.log('Parsed Data:', results.data); // Log the parsed data
                            const newsContainer = document.getElementById('news-container');
                            results.data.reverse().forEach(row => {
                                if (!row.Nadpis || !row.Novinka || !row.Datum || !row.Podpis) return; // Skip incomplete rows

                                const cardRow = document.createElement('div');
                                cardRow.className = 'row mb-4 d-flex justify-content-center';

                                const card = document.createElement('div');
                                card.className = 'col-md-8';
                                card.innerHTML = `
                                    <div class="card border-secondary">
                                        <div class="card-header">${row.Nadpis}</div>
                                        <div class="card-body">                                            
                                            <p class="card-text">${row.Novinka}</p>
                                            <div class="d-flex justify-content-between w-100">
                                                <p class="card-text mb-0"><small class="text-muted">${row.Datum}</small></p>
                                                <p class="card-text mb-0"><small class="text-muted">${row.Podpis}</small></p>
                                            </div>
                                        </div>
                                    </div>
                                `;
                                cardRow.appendChild(card);
                                newsContainer.appendChild(cardRow);
                            });
                        },
                        error: function(error) {
                            console.error('Error parsing the CSV data:', error);
                        }
                    });
                })
                .catch(error => console.error('Error fetching the CSV data:', error));
        });
    </script>
</body>
</html>