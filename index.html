<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News Website</title>
    <!-- Include Custom Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Dummy Favicon Link to Suppress 404 Error -->
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-light" data-bs-theme="light">
        <div class="container-fluid justify-content-center">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-center" id="navbarColor03">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="nav-novinky">Novinky
                            <span class="visually-hidden">(current)</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="nav-informace">Informace</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Dropdown</a>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" href="#">Action</a>
                            <a class="dropdown-item" href="#">Another action</a>
                            <a class="dropdown-item" href="#">Something else here</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">Separated link</a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-5" id="content-container">
        <!-- Content will be loaded here -->
    </div>

    <!-- Include Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <!-- Include Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <!-- Include jQuery for simplicity -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <!-- Include PapaParse -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script>
        $(document).ready(function() {
            // Function to load content
            function loadContent(url, callback) {
                $('#content-container').load(url, callback);
            }

            // Function to fetch and display news
            function fetchAndDisplayNews() {
                const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQXlfXRcfpV8LdX0ZlryLEwwOs8YgzHLrgFsGheBJ5bSuR9CMGBkZlQPNQNyO_rJxCNWkoedIvZOkq5/pub?output=csv';
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/';

                fetch(proxyUrl + sheetUrl)
                    .then(response => response.text())
                    .then(data => {
                        console.log('Fetched CSV Data:', data); // Log the fetched CSV data
                        Papa.parse(data, {
                            header: true,
                            complete: function(results) {
                                console.log('Parsed Data:', results.data); // Log the parsed data
                                const newsContainer = document.getElementById('news-container');
                                newsContainer.innerHTML = ''; // Clear previous content
                                results.data.reverse().forEach(row => {
                                    if (!row.Nadpis || !row.Novinka || !row.Datum || !row.Podpis) return; // Skip incomplete rows

                                    const cardRow = document.createElement('div');
                                    cardRow.className = 'row mb-4 d-flex justify-content-center';

                                    const card = document.createElement('div');
                                    card.className = 'col-md-8';
                                    card.innerHTML = `
                                        <div class="card border-secondary">
                                            <div class="card-header">${row.Nadpis}</div>
                                            <div class="card-body">                                            
                                                <p class="card-text">${row.Novinka}</p>
                                                <div class="d-flex justify-content-between w-100">
                                                    <p class="card-text mb-0"><small class="text-muted">${row.Datum}</small></p>
                                                    <p class="card-text mb-0"><small class="text-muted">${row.Podpis}</small></p>
                                                </div>
                                            </div>
                                        </div>
                                    `;
                                    cardRow.appendChild(card);
                                    newsContainer.appendChild(cardRow);
                                });
                            },
                            error: function(error) {
                                console.error('Error parsing the CSV data:', error);
                            }
                        });
                    })
                    .catch(error => console.error('Error fetching the CSV data:', error));
            }

            // Load Novinky content by default
            loadContent('novinky.html', fetchAndDisplayNews);

            // Handle navbar clicks
            $('#nav-novinky').click(function(e) {
                e.preventDefault();
                loadContent('novinky.html', fetchAndDisplayNews);
            });

            $('#nav-informace').click(function(e) {
                e.preventDefault();
                loadContent('informace.html'); // Assuming you have an 'informace.html' file
            });
        });
    </script>
</body>
</html>